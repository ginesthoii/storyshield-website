<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Features - StoryShield</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        var CLIENT_ID = '190987035372-qbj55j4ashlq846givk0l8mrfgbhl2o5.apps.googleusercontent.com';
        var API_KEY = 'AIzaSyAuBAGeLvf2Fm5VkDHNuwqWql-LqJR1Siw';  // Your actual API key

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
                scope: "https://www.googleapis.com/auth/spreadsheets.readonly"
            }).then(function () {
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            }, function(error) {
                console.error("Error initializing Google API client: ", error);
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                document.getElementById('signin-button').style.display = 'none';
                loadSheetData();
            } else {
                document.getElementById('signin-button').style.display = 'block';
            }
        }

        function handleSignInClick() {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignOutClick() {
            gapi.auth2.getAuthInstance().signOut();
        }

        function loadSheetData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1pxi_XbyR4C7GHM1aYKDkUESuYpFeLFihBkbyJ171AlI',
                range: 'Sheet1!A1:E10',
            }).then(function(response) {
                var range = response.result;
                if (range.values.length > 0) {
                    var table = document.createElement('table');
                    for (i = 0; i < range.values.length; i++) {
                        var row = range.values[i];
                        var tr = document.createElement('tr');
                        for (j = 0; j < row.length; j++) {
                            var td = document.createElement('td');
                            td.textContent = row[j];
                            tr.appendChild(td);
                        }
                        table.appendChild(tr);
                    }
                    document.body.appendChild(table);
                } else {
                    console.log('No data found.');
                }
            }, function(response) {
                console.error('Error: ' + response.result.error.message);
                alert('Failed to load data. Please try again later.');
            });
        }
    </script>
</head>
<body>
    <header>
        <h1>Features</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="features.html">Features</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section>
            <h2>Key Features</h2>
            <ul>
                <li>Robust encryption and secure data handling</li>
                <li>Integration with Google Sheets</li>
                <li>Customizable reading lists</li>
                <li>Insightful analytics</li>
                <li>Advanced security tips</li>
            </ul>
            <button id="signin-button" onclick="handleSignInClick()">Sign In</button>
            <button id="signout-button" onclick="handleSignOutClick()" style="display:none;">Sign Out</button>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 StoryShield. All rights reserved.</p>
    </footer>
    <script>
        handleClientLoad();
    </script>
</body>
</html>